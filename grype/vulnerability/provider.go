package vulnerability

// Criteria interfaces are used for FindVulnerabilities calls
type Criteria interface {
	// MatchesVulnerability returns true if the provided value meets the criteria
	MatchesVulnerability(value Vulnerability) bool
}

// Finder implementations provide ways to search for and return vulnerabilities
type Finder interface {
	// FindVulnerabilities returns vulnerabilities matching all the provided criteria
	FindVulnerabilities(criteria ...Criteria) ([]Vulnerability, error)
}

// MetadataProvider implementations provide ways to look up vulnerability metadata
type MetadataProvider interface {
	// VulnerabilityMetadata returns the metadata associated with a vulnerability
	VulnerabilityMetadata(ref Reference) (*Metadata, error)
}

// Provider is the common interface for vulnerability sources to provide searching and metadata, such as a database
type Provider interface {
	Finder
	MetadataProvider
}
