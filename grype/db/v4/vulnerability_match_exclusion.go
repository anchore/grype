package v4

// VulnerabilityMatchExclusion represents the minimum data fields necessary to automatically filter certain
// vulnerabilities from match results based on the specified constraints.
type VulnerabilityMatchExclusion struct {
	ID            string                                  // The identifier of the vulnerability or advisory
	Constraints   []VulnerabilityMatchExclusionConstraint // The constraints under which the exclusion applies
	Justification string                                  // Justification for the exclusion
}

// VulnerabilityMatchExclusionConstraint describes criteria for which matches should be excluded
type VulnerabilityMatchExclusionConstraint struct {
	Namespaces           []string                                         // Vulnerability namespaces
	FixStates            []FixState                                       // Vulnerability fix states
	EcosystemConstraints []VulnerabilityMatchExclusionEcosystemConstraint // Ecosystem-specific constraints
}

// VulnerabilityMatchExclusionEcosystemConstraint describes criteria for which matches should be excluded within an
// ecosystem
type VulnerabilityMatchExclusionEcosystemConstraint struct {
	Language           string                                         // A language ecosystem
	PackageType        string                                         // A package ecosystem
	PackageConstraints []VulnerabilityMatchExclusionPackageConstraint // Package-specific constraints
}

// VulnerabilityMatchExclusionPackageConstraint describes the package criteria for which matches should be excluded
type VulnerabilityMatchExclusionPackageConstraint struct {
	PackageName string   // The name of a package
	Versions    []string // Package versions
	Locations   []string // Package locations
}
