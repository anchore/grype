package db

import (
	v6 "github.com/anchore/grype/grype/db/v6"
	"github.com/anchore/grype/grype/distro"
	"github.com/anchore/grype/grype/vulnerability"
	"github.com/anchore/syft/syft/cpe"
	syftPkg "github.com/anchore/syft/syft/pkg"
)

type Reader = v6.Reader

func NewVulnerabilityProvider(reader Reader) vulnerability.Provider {
	return v6.NewVulnerabilityProvider(reader)
}

// ByPackageName returns criteria restricting vulnerabilities to match the package name provided
func ByPackageName(name string) vulnerability.Criteria {
	return v6.NewPackageNameCriteria(name)
}

// ByID returns criteria to search by vulnerability ID, such as CVE-2024-9000
func ByID(id string) vulnerability.Criteria {
	return v6.NewIDCriteria(id)
}

// ByCPE returns criteria which will search based on the provided CPE
func ByCPE(c *cpe.CPE) vulnerability.Criteria {
	return v6.NewCPECriteria(c)
}

// ByDistro returns criteria which will search based on the provided Distro
func ByDistro(d *distro.Distro) vulnerability.Criteria {
	return v6.NewDistroCriteria(d)
}

// ByEcosystem returns criteria which will search based on the package ecosystem
func ByEcosystem(l *syftPkg.Language) vulnerability.Criteria {
	return v6.NewLanguageCriteria(l)
}
