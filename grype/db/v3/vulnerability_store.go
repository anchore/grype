package v3

const VulnerabilityStoreFileName = "vulnerability.db"

type SerializedVulnerabilities = interface{}

type VulnerabilityStore interface {
	VulnerabilityStoreReader
	VulnerabilityStoreWriter
}

type VulnerabilityStoreReader interface {
	// GetVulnerability retrieves vulnerabilities associated with a namespace and a package name
	GetVulnerability(namespace, name string) ([]Vulnerability, error)
	// GetAllSerializedVulnerabilities retrieves all serialized vulnerabilities
	GetAllSerializedVulnerabilities() (SerializedVulnerabilities, error)
}

type VulnerabilityStoreWriter interface {
	// AddVulnerability inserts a new record of a vulnerability into the store
	AddVulnerability(vulnerabilities ...Vulnerability) error
}
